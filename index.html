<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Màu Sắc Hoàn Thiện</title>
    <style>
        /* === 1. CSS CHUNG === */
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        .quiz-container {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            text-align: center;
        }

        h1 { color: #2c3e50; margin-bottom: 5px; }
        .instruction { color: #7f8c8d; margin-bottom: 25px; }
        
        /* === 2. CSS VÙNG CÂU HỎI VÀ ĐÁP ÁN === */
        #questionCounter {
            font-weight: bold;
            color: #3498db;
            margin-bottom: 15px;
        }

        .question-area {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        #colorQuestion {
            width: 80px;
            height: 80px;
            margin: 10px auto;
            border-radius: 50%;
            border: 4px solid #bdc3c7;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        #vietnameseQuestion {
            font-size: 1.4em;
            font-weight: bold;
            color: #34495e;
            margin-top: 10px;
        }

        .answers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .answer-btn {
            padding: 15px 10px;
            font-size: 1.1em;
            font-weight: bold;
            border: 2px solid #3498db;
            border-radius: 8px;
            background-color: #ecf0f1;
            color: #2c3e50;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        .answer-btn:hover:not(:disabled) {
            background-color: #3498db;
            color: white;
            transform: translateY(-2px);
        }
        
        .answer-btn:disabled {
            cursor: default;
            opacity: 1; /* Giữ nguyên độ đậm khi disabled */
        }
        .correct-answer { background-color: #2ecc71 !important; color: white !important; border-color: #2ecc71 !important; }
        .wrong-answer { background-color: #e74c3c !important; color: white !important; border-color: #e74c3c !important; }
        
        #feedback { font-size: 1.3em; font-weight: bold; min-height: 25px; margin-bottom: 10px; }
        .correct-text { color: #2ecc71; }
        .wrong-text { color: #e74c3c; }

        /* === 3. CSS KẾT QUẢ & NÚT === */
        #nextButton, #resultButton, #retryButton {
            padding: 12px 25px;
            font-size: 1.1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        #nextButton { background-color: #e67e22; color: white; display: none; }
        #resultButton { background-color: #3498db; color: white; display: none; }
        #retryButton { background-color: #2ecc71; color: white; margin-left: 10px; }

        #resultScreen {
            padding: 20px;
            text-align: left;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        .result-item { margin-bottom: 15px; border-bottom: 1px dashed #eee; padding-bottom: 10px; }
        .result-item:last-child { border-bottom: none; }
        .result-color-display {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            vertical-align: middle;
            margin-right: 10px;
            border: 1px solid #333;
        }
        .summary { font-size: 1.5em; font-weight: bold; margin-bottom: 20px; }

    </style>
</head>
<body>

    <div class="quiz-container">
        <h1>BÀI KIỂM TRA MÀU SẮC</h1>
        <p class="instruction">Bạn cần hoàn thành 16 câu hỏi để xem kết quả.</p>

        <div id="quizScreen">
            <div id="questionCounter">Câu hỏi 1 / 16</div>
            <div class="question-area">
                <div id="colorQuestion"></div>
                <div id="vietnameseQuestion"></div>
            </div>

            <div class="answers" id="answerButtons">
                </div>

            <div id="feedback"></div>

            <button id="nextButton" onclick="nextQuestion()">Tiếp Tục →</button>
            <button id="resultButton" onclick="showResults()">Xem Kết Quả</button>
        </div>

        <div id="resultScreen">
            <div class="summary"></div>
            <div id="resultDetails"></div>
            <button id="retryButton" onclick="resetQuiz(true)">Làm Lại (Đảo thứ tự)</button>
            <button id="backToQuizButton" onclick="resetQuiz(false)">Làm Lại (Giữ thứ tự)</button>
        </div>
    </div>

    <script>
        // === 2. JAVASCRIPT XỬ LÝ LOGIC QUIZ ===

        // Dữ liệu gốc 16 màu
        const allColors = [
            { en: "BLACK", vn: "ĐEN", hex: "#000000" },
            { en: "BLUE", vn: "XANH DƯƠNG", hex: "#0086FF" },
            { en: "SKY BLUE", vn: "XANH DA TRỜI", hex: "#87CEEB" },
            { en: " LIGHT BROWN", vn: "NÂU NHẠT", hex: "#ae6318" },
            { en: "DARK BROWN", vn: "NÂU ĐẬM", hex: "#4e3215" },
            { en: "BROWN", vn: "NÂU", hex: "#964B00" },
            { en: "GREEN", vn: "XANH LÁ CÂY", hex: "#008000" },
            { en: "LIGHT GREEN", vn: "XANH LÁ LỢT", hex: "#90EE90" },
            { en: "DARK GREEN", vn: "XANH LÁ ĐẬM", hex: "#0f5e0f" },
            { en: "VIOLET", vn: "TÍM", hex: "#8A2BE2" },
            { en: "LAVENDER", vn: "TÍM NHẠT", hex: "#E6E6FA" },
            { en: "GREY", vn: "XÁM", hex: "#A9A9A9" },
            { en: "DARK GREY", vn: "XÁM ĐẬM", hex: "#808080" },
            { en: "LIGHT GREY", vn: "XÁM NHẠT", hex: "#c3c3c3" },
            { en: "DARK RED", vn: "ĐỎ ĐẬM", hex: "#af0000" },
            { en: "LIGHT RED", vn: "ĐỎ NHẠT", hex: "#f96464" },
            { en: "RED", vn: "ĐỎ", hex: "#FF0000" },
            { en: "LIGHT YELLOW", vn: "VÀNG NHẠT", hex: "#f3f38e" },
            { en: "DARK YELLOW", vn: "VÀNG ĐẬM", hex: "#c5c503" },
            { en: "YELLOW", vn: "VÀNG", hex: "#FFFF00" },
            { en: "PINK", vn: "HỒNG", hex: "#FFC0CB" },
            { en: "LIGHT PINK", vn: "HỒNG NHẠT", hex: "#f9cad2" },
            { en: "DARK PINK", vn: "HỒNG ĐẬM", hex: "#fa94a6" },
            { en: "ORANGE", vn: "CAM", hex: "#FFA500" },
            { en: "WHITE", vn: "TRẮNG", hex: "#FFFFFF" },
            { en: "BEIGE", vn: "MÀU BE", hex: "#E5CB9B" },
            
        ];
        
        let questionsOrder = []; // Thứ tự các màu sẽ được hỏi
        let currentQuestionIndex = 0;
        let quizResults = []; // Lưu trữ kết quả: {color, isCorrect, selectedAnswer}

        // Hàm xáo trộn mảng (Fisher-Yates Shuffle)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- HÀM TẠO VÀ TẢI QUIZ ---

        // Hàm khởi tạo/reset Quiz
        function resetQuiz(shuffle) {
            // Khôi phục màn hình
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';

            // Thiết lập thứ tự câu hỏi
            questionsOrder = Array.from(allColors);
            if (shuffle) {
                shuffleArray(questionsOrder);
            }
            
            currentQuestionIndex = 0;
            quizResults = [];
            loadQuestion();
        }

        // Hàm tải câu hỏi hiện tại
        function loadQuestion() {
            // Xóa trạng thái cũ
            document.getElementById('feedback').textContent = '';
            document.getElementById('nextButton').style.display = 'none';
            document.getElementById('resultButton').style.display = 'none';
            document.getElementById('answerButtons').innerHTML = '';
            document.getElementById('questionCounter').textContent = `Câu hỏi ${currentQuestionIndex + 1} / ${questionsOrder.length}`;

            // Lấy màu hiện tại
            const currentColor = questionsOrder[currentQuestionIndex];
            const correctColorIndex = allColors.findIndex(c => c.en === currentColor.en);
            const correctEnName = currentColor.en;
            
            // 1. Chuẩn bị đáp án ngẫu nhiên
            let wrongColors = allColors.filter((_, index) => index !== correctColorIndex);
            shuffleArray(wrongColors);
            
            const wrongAnswers = wrongColors.slice(0, 3).map(color => color.en);
            const allAnswers = [correctEnName, ...wrongAnswers];
            shuffleArray(allAnswers);

            // 2. Hiển thị câu hỏi (Ô màu + Tên VN)
            const colorDisplay = document.getElementById('colorQuestion');
            const vnQuestionText = document.getElementById('vietnameseQuestion');
            
            colorDisplay.style.backgroundColor = currentColor.hex;
            colorDisplay.style.border = (currentColor.hex === "#FFFFFF" || currentColor.hex === "#F5F5DC") ? "4px solid #333" : "4px solid #bdc3c7";
            vnQuestionText.textContent = currentColor.vn.toUpperCase();

            // 3. Hiển thị các nút đáp án
            const answerButtonsContainer = document.getElementById('answerButtons');
            allAnswers.forEach(answer => {
                const button = document.createElement('button');
                button.textContent = answer;
                button.classList.add('answer-btn');
                button.onclick = () => checkAnswer(button, answer, correctEnName);
                answerButtonsContainer.appendChild(button);
                button.disabled = false; // Đảm bảo nút được kích hoạt
            });
        }
        
        // --- HÀM KIỂM TRA ĐÁP ÁN ---

        function checkAnswer(selectedButton, selectedAnswer, correctAnswer) {
            const feedback = document.getElementById('feedback');
            
            // 1. Vô hiệu hóa tất cả các nút
            document.querySelectorAll('.answer-btn').forEach(btn => btn.disabled = true);
            
            const isCorrect = selectedAnswer === correctAnswer;

            // 2. Lưu kết quả
            const currentColor = questionsOrder[currentQuestionIndex];
            quizResults[currentQuestionIndex] = {
                color: currentColor,
                isCorrect: isCorrect,
                selectedAnswer: selectedAnswer
            };

            // 3. Hiển thị phản hồi
            if (isCorrect) {
                feedback.textContent = "Chính xác! 🎉";
                feedback.className = 'correct-text';
                selectedButton.classList.add('correct-answer');
            } else {
                feedback.textContent = `Sai rồi. 😔 Đáp án đúng là ${correctAnswer}`;
                feedback.className = 'wrong-text';
                selectedButton.classList.add('wrong-answer');

                // Highlight đáp án đúng
                document.querySelectorAll('.answer-btn').forEach(btn => {
                    if (btn.textContent === correctAnswer) {
                        btn.classList.add('correct-answer');
                    }
                });
            }

            // 4. Hiển thị nút Tiếp tục/Xem kết quả
            if (currentQuestionIndex < questionsOrder.length - 1) {
                document.getElementById('nextButton').style.display = 'block';
            } else {
                document.getElementById('resultButton').style.display = 'block';
            }
        }
        
        // --- HÀM CHUYỂN CÂU HỎI ---

        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        // --- HÀM HIỂN THỊ KẾT QUẢ ---

        function showResults() {
            document.getElementById('quizScreen').style.display = 'none';
            const resultScreen = document.getElementById('resultScreen');
            resultScreen.style.display = 'block';

            const correctCount = quizResults.filter(r => r.isCorrect).length;
            const wrongCount = quizResults.length - correctCount;

            // Hiển thị tóm tắt
            const summary = document.querySelector('.summary');
            summary.innerHTML = `Bạn đã hoàn thành! <br>Đúng: <span class="correct-text">${correctCount}</span> | Sai: <span class="wrong-text">${wrongCount}</span>`;

            // Hiển thị chi tiết từng câu
            const detailsContainer = document.getElementById('resultDetails');
            detailsContainer.innerHTML = '<h3>Chi Tiết Từng Câu:</h3>';

            quizResults.forEach((result, index) => {
                const item = document.createElement('div');
                item.classList.add('result-item');
                const status = result.isCorrect ? 'ĐÚNG' : 'SAI';
                const statusClass = result.isCorrect ? 'correct-text' : 'wrong-text';
                const colorDisplay = `<span class="result-color-display" style="background-color: ${result.color.hex}; border-color: ${(result.color.hex === "#FFFFFF" || result.color.hex === "#F5F5DC") ? "#333" : result.color.hex};"></span>`;

                item.innerHTML = `
                    <p>
                        ${colorDisplay} 
                        **Câu ${index + 1}:** ${result.color.vn.toUpperCase()} (${result.color.en}) - 
                        <span class="${statusClass}">**${status}**</span>
                    </p>
                    <p style="margin-top: -10px; font-size: 0.9em;">
                        &nbsp; &nbsp; &nbsp; &nbsp; Đáp án bạn chọn: **${result.selectedAnswer}**
                    </p>
                `;
                detailsContainer.appendChild(item);
            });
        }

        // Khởi tạo Quiz lần đầu (không xáo trộn)
        window.onload = () => resetQuiz(false);

    </script>
</body>

</html>

